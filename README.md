<!-- vim:set ts=4 sts=4 sw=4 tw=0: -->

# 概要。
基本的に、F1キーとの組み合わせにより、Steamゲームを起動できるようにしたスクリプトファイルである。  
今回は、ショートカットファイルがデスクトップにあることを想定している。  
そのデスクトップとは、個人ユーザのデスクトップのことであり、それ以外は考慮していない。
そのため、他の場所に置いているのであれば、Pathを書き換える必要がある。  

何より当たり前のことは、私のWindows10端末で動かすことを前提にしているため、他の環境では動かない可能性がある。  

ちなみに、本命は、
[ドットファイルのAutoHotKey](https://github.com/asakunotomohiro/dotfiles/blob/master/Windows/AutoHotkey.ahk)
であり、本ファイルがある程度完成したならば、そちらに取り込まれる。  
もちろん、ゲームだけに特化する場合であれば、本ファイルのみを用いた方がいいだろう。  

## 事前準備物
1. 当然だがSteamがインストールされていること。  
しかも、標準インストール場所であること。  
しかし、ファイルの中身を見ればわかるとおり、Pathを書き換えるのであれば、この限りではない。  

2. 遊びたいゲームのショートカットファイルをデスクトップ上に置くこと。  
Pathを任意の場所に書き換えることで、デスクトップ上がきれいに片付くことだろう。  

3. 言わずもがな。  
AutoHotkey本体もインストール済みであること。  

## 実際の運用。
基本的には、F1キーとの組み合わせを基準にしている。
ゆえに、好きに書き換えてくれ。  

例えば、`F1`キーと`o`キーの組み合わせにより、 **Oxygen Not Included** を立ち上げるためのGUIが立ち上がる(ややこしいぞ)。  
そして、そこから目的のゲームを選び、Okボタンを押すことで、ゲームが起動する。  
ダブルクリックでの起動はできない(意図しない動きをしてしまったため)。  

気になる(注意する)のは、ショートカットファイルの拡張子だ。  
ゲームするだけならば気づかなかったが、リンクファイルではなく、URLファイルだった。  
そのため、書き換える場合は、気をつけた方がいいだろう。  

### ゲーム起動後
常駐しない仕様になっている。  

常駐させても良かったが、本来であれば、本命プログラムを常駐させるため、今回のプログラムを常駐させる意義が薄れるだろうとの判断だ。  
それを考慮し、ゲーム起動に特化したプログラムにしている。  

### Pathの書き換え方法。
今までの説明からわかるだろうが、ショートカットファイル名を記載すること(フルPathであること)。  
AutoHotKeyが用意している変数名との組み合わせでフルPathになっていれてもよい(見ればわかるだろうが)。  

見栄えの問題として、配列にショートカットファイルを記述する場合、空行を付けることにしている。  

```ahk:抜粋.ahk
GameArray := [	; ここが1行目の空行
		 , A_Desktop . "\[ゲーム用ショートカットファイル名].url"	; ここが2行目
		 , A_Desktop . "\Flockers.url"	; 3行目。
		 , ""]	; 4行目も空行。
```

この空行を基準にプログラムが動くため、記述場所には気をつけること。  

また、コメントアウト化で、配列数も短くなる。
```ahk:抜粋.ahk
GameArray := [	; ここが1行目の空行
		 , "C:\Users\Public\Desktop\[ゲーム用ショートカットファイル名].url"	; ここが2行目
;		 , A_Desktop . "\Flockers.url"	; コメントアウトしているため、配列として数えない。
		 , ""]	; 3行目も空行。
```

当然、空行追加は、配列として数えられる。
```ahk:抜粋.ahk
GameArray := [	; ここが1行目の空行
		 , "C:\Users\Public\Desktop\Flockers.url"	; ここが2行目
		 , ""	; 3行目空行。
		 , ""]	; 4行目空行(3行目の空行を配列として含めるため)。
```

以下のように、URL表記でも問題ない。
```ahk:抜粋.ahk
GameArray := [
		 , "steam://～～～	オキシゲンノットインクルード"
		 , "steam://～～～	ヒットマン"
		 , "steam://～～～	シムシティ"
		 , ""]
```
ゲームexe名だけでもかまわないが、他のゲーム名と同じ場合、ディレクトリ名を含める必要がある。  
"Launcher.exe"ではなく、
"HITMAN2\Launcher.exe"とすること。  
そして、GUIの起動に時間がかかるため、止めた方がいい。  
推奨値は、ショートカットファイル名を記述すること。  

そこまで厳密な動作確認はしていない(境界値テストが甘い)ため、既存の箇所のみを変えるのが無難だろう。  
また、1行のみにした場合、GUI画面を出さずにゲームが起動する(ショートカットファイルかURL指定のみ)。  
そして、その場合は、本スクリプトが終了せず、常駐する。

#### 上記配列を利用して、ゲーム起動用GUI起動
上記の配列は、単純にショートカットファイルの指定なだけで、それだけでは呼び出せない。  
そのため、下記の関数に配列名を渡し、関数を呼び出す必要がある。  
`Launch2steam4autoHotKey(GameArray)`

#### その前段階として
そもそもキーの組み合わせで上記仕込みが成り立つわけで・・・下記の呼び出しが必須になる。
```AutoHotKey:sample.ahk
F1 & o::	; ここの呼び出しは、F1キーと任意の英字を指定する。
	; ほにゃらら。
return
```

任意の英字は、1箇所のみ使える。  
```AutoHotKey:sample.ahk
F1 & o::
	; ほにゃらら。
return

F1 & o::	; 他で宣言している場合、エラーになる。
	; ホニャララ。
return
```

という二重定義はエラーになる。  

このあたりは、AutoHotkeyの仕様であって、私には全く関係の無いこと。  
そのため、私に聞かれても困るため、勝手に調べること。  
ましてや、AutoHotkeyの開発者に聞かないこと。  

### ゲーム起動の組み合わせ。
**注意**：`<F1-a>`と書くことで、F1キー押下したままaキー押下を表す。  

* `<F1-o>`：Oxygen Not Included起動  
  他にもOpenTTDが立ち上がるようにしている。  
* `<F1-h>`：ヒットマンシリーズを立ち上げるようにしている。  
  他には、Sniper Eliteシリーズの起動を含めている。  
* `<F1-F>`：Factorioの起動。  
  頭文字が同じと言うことで、Flockersが立ち上がるようにしている。  
* `<F1-c>`：シミュレーション系と言うことで、SimCityの起動をしている。  
  もっとも、Simcityだけは、Steamとは別のゲームとして起動する。  
  Steamに関係のあるゲームは、シティーズスカイライン・バニッシュ・テオタウン・オープンTTDぐらい・・・。  
* `<F1-p>`：サウンドトラック  
  Steamからサウンドトラックのショートカットファイルをデスクトップに作れないが、作れた物を登録している。  
* `<F1-g>`：とりあえず、めぼしいゲームを登録している。  

## ライセンス
[GNU General Public License, version 2](https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html)  

以上。  
